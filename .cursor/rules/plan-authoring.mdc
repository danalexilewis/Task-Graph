---
description: Cursor plan format and how to write good task dependencies
globs: plans/**/*.md
alwaysApply: false
---

# Plan Authoring (Cursor Format)

Plans in `plans/` use Cursor format for import into taskgraph via `tg import --format cursor`.

## YAML Frontmatter Structure

```yaml
---
name: Plan Name
overview: "Brief description of the plan."
todos:
  - id: stable-key
    content: "Task title and description"
    status: pending
  - id: another-task
    content: "Depends on first"
    blockedBy: [stable-key]
isProject: false
---
```

## Todo Fields

| Field | Required | Description |
|-------|----------|-------------|
| `id` | yes | Stable key → maps to `external_key`. Use kebab-case. |
| `content` | yes | Task title (maps to task title) |
| `status` | no | `pending` → todo, `completed` → done |
| `blockedBy` | no | Array of todo `id`s that block this task. Creates `blocks` edges on import. |
| `domain` | no | Knowledge area → maps to `docs/<domain>.md`. Agent reads this before starting. Use a slug (e.g. `schema`, `cli`, `plan-import`). |
| `skill` | no | Technique required → maps to `docs/skills/<skill>.md`. Use kebab-case (e.g. `sql-migration`, `yaml-parsing`, `cli-command`). |
| `changeType` | no | How to approach: `create`, `modify`, `refactor`, `fix`, `investigate`, `test`, `document`. Shapes agent behavior (e.g. refactor = test before/after). |

## When to use domain, skill, changeType

- **domain**: Set when the task touches a specific area of the codebase or docs; the agent will read that doc for conventions and prior decisions.
- **skill**: Set when the task requires a particular technique (migrations, parsing, CLI design); the agent can load the skill guide and see past tasks with the same skill.
- **changeType**: Set when the approach matters: use `refactor` for behavior-preserving changes, `fix` for bugs (reproduce first), `create` for net-new work, `document` for docs-only.

## Dependency Best Practices

- Use `blockedBy` for tasks that cannot start until others are done.
- Reference `id` values; they resolve to task IDs when importing.
- Keep tasks scoped (~90 min or less); split large ones.
- Order todos to reflect dependency graph when possible.
